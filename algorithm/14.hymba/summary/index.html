<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hymba 아키텍처: 시각적 심층 분석</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f8fafc; }
        .chart-container { position: relative; width: 100%; max-width: 800px; margin-left: auto; margin-right: auto; height: 50vh; max-height: 500px; }
        .gradient-text { background: linear-gradient(to right, #0077B6, #00B4D8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .section-card { background-color: white; border-radius: 0.75rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); padding: 2.5rem; margin-bottom: 3rem; border: 1px solid #e5e7eb; }
        .flow-arrow { font-size: 2rem; color: #90E0EF; line-height: 1; }
        .flow-box { border: 2px solid #CAF0F8; background-color: #f0f9ff; padding: 0.75rem 1.5rem; border-radius: 0.5rem; text-align: center; font-weight: 500; color: #0369a1; }
        .nav-link { @apply px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-blue-100 hover:text-blue-800 transition-colors; }
        .nav-link.active { @apply bg-blue-600 text-white hover:bg-blue-700; }
    </style>
</head>
<body class="text-gray-800">

    <header class="bg-white/90 backdrop-blur-sm sticky top-0 z-50 shadow-md">
        <nav class="container mx-auto px-4 py-3 flex justify-between items-center">
            <a href="./index.html" class="text-xl font-bold gradient-text">Hymba Research</a>
            <div id="nav-links" class="hidden md:flex items-center space-x-2">
                <a href="./index.html" class="nav-link">| 개요</a>
                <a href="./swa_kv_cache.html" class="nav-link">| SWA & KV Cache</a>
                <a href="./kv_cache.html" class="nav-link">| KV Cache</a>
                <a href="./meta_token.html" class="nav-link">| 메타 토큰</a>
                <a href="./train_recipe.html" class="nav-link">| 학습 레시피</a>
                <a href="./design_roadmap.html" class="nav-link">| 설계 로드맵</a>
                <a href="./dpo_evolution.html" class="nav-link">| DPO와 그 발전 |</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 py-12 md:py-20">
        <section class="text-center mb-20">
            <h1 class="text-4xl md:text-6xl font-bold gradient-text mb-4">Hymba 아키텍처</h1>
            <p class="text-xl md:text-2xl text-gray-600 max-w-3xl mx-auto">고성능 리콜과 초효율 요약의 완벽한 융합: 차세대 소형 언어 모델의 청사진</p>
        </section>

        <section class="section-card">
            <h2 class="text-3xl font-bold text-center mb-2 text-[#0077B6]">현대 LLM의 딜레마: 성능 vs. 효율</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-10">
                기존 어텐션 메커니즘은 모든 토큰 쌍을 비교하여 높은 성능을 달성하지만, 시퀀스 길이가 길어질수록 계산 비용이 기하급수적으로 증가($O(N^2)$)합니다. 반면, Mamba와 같은 SSM은 선형적($O(N)$)으로 증가하여 효율적입니다. 아래 슬라이더를 움직여 그 차이를 직접 확인해보세요.
            </p>
            <div class="chart-container">
                <canvas id="complexityChart"></canvas>
            </div>
            <div class="mt-8 max-w-xl mx-auto">
                <label for="sequenceLength" class="block text-center font-medium text-gray-700">시퀀스 길이 (N): <span id="sequenceLengthValue" class="font-bold text-[#5D7D9A]">1024</span></label>
                <input id="sequenceLength" type="range" min="64" max="4096" step="64" value="1024" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
            </div>
            <div id="complexity-text" class="mt-4 text-center text-gray-700 bg-gray-50 p-4 rounded-lg max-w-xl mx-auto">
                결과를 여기에 표시합니다.
            </div>
        </section>

        <section class="section-card">
            <h2 class="text-3xl font-bold text-center mb-10 text-[#0077B6]">Hymba 패러다임: 병렬 하이브리드 헤드</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-12">
                Hymba의 핵심 혁신은 어텐션과 SSM을 순차적으로 쌓는 대신, 동일한 레이어 내에서 병렬로 처리하는 '하이브리드 헤드'에 있습니다. 동일한 입력이 두 메커니즘에 동시에 노출되어, 모델이 '정밀 검색(어텐션)'과 '맥락 요약(SSM)'을 동시에 수행하고 그 결과를 최적으로 결합하는 법을 학습합니다.
            </p>
            <div class="flex flex-col items-center space-y-4">
                <div class="flow-box">입력 (x)</div>
                <div class="flow-arrow">↓</div>
                <div class="w-full grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="flex flex-col items-center space-y-4 p-4 bg-gray-50 rounded-lg">
                        <div class="flow-box w-full">🔍 어텐션 헤드 ("Fact-Checker")</div>
                        <p class="text-sm text-gray-500 text-center">특정 정보에 대한 고해상도 리콜. "바다에서 바늘 찾기"와 같은 정밀 검색 작업 수행.</p>
                    </div>
                    <div class="flex flex-col items-center space-y-4 p-4 bg-gray-50 rounded-lg">
                        <div class="flow-box w-full">🧠 SSM 헤드 ("Summarizer")</div>
                        <p class="text-sm text-gray-500 text-center">전체 시퀀스에 대한 효율적인 컨텍스트 요약. 글의 전반적인 흐름과 주제 파악.</p>
                    </div>
                </div>
                <div class="flow-arrow">↓</div>
                <div class="flow-box">결합 및 프로젝션</div>
                <div class="flow-arrow">↓</div>
                <div class="flow-box">출력</div>
            </div>
        </section>

        <section class="section-card">
            <h2 class="text-3xl font-bold text-center mb-10 text-[#0077B6]">성능 혁명: 수치로 보는 효율성</h2>
            <p class="text-center text-gray-600 max-w-3xl mx-auto mb-12">
                SSM의 선형적 효율성, 슬라이딩 윈도우 어텐션, KV 캐시 공유 등 다양한 최적화 기법을 통해 Hymba는 기존 모델 대비 압도적인 효율성 이점을 달성합니다. 이는 더 긴 문맥을 더 적은 자원으로 처리할 수 있음을 의미합니다.
            </p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <div class="text-center">
                    <p class="text-6xl md:text-7xl font-bold text-[#0077B6]">11.67x</p>
                    <p class="text-xl font-medium text-gray-700 mt-2">KV 캐시 크기 감소</p>
                    <p class="text-gray-500">유사 크기 모델 대비</p>
                    <hr class="my-8">
                    <p class="text-6xl md:text-7xl font-bold text-[#00B4D8]">3.49x</p>
                    <p class="text-xl font-medium text-gray-700 mt-2">처리량 향상</p>
                    <p class="text-gray-500">긴 시퀀스 추론 시</p>
                </div>
                <div class="chart-container h-[50vh] max-h-[500px]">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
        </section>

        <!-- ADDED QUIZ BUTTON SECTION -->
        <section class="text-center mt-12">
            <a href="https://g.co/gemini/share/2176a121d27d" 
               target="_blank" rel="noopener noreferrer"
               class="inline-block bg-gradient-to-r from-blue-600 to-cyan-500 text-white font-bold text-lg px-8 py-4 rounded-lg shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300">
                퀴즈 풀러가기!
            </a>
        </section>
        
    </main>

<script>
document.addEventListener('DOMContentLoaded', function () {
    // Navigation active state
    const navLinks = document.querySelectorAll('#nav-links .nav-link');
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    navLinks.forEach(link => {
        if (link.getAttribute('href').includes(currentPage)) {
            link.classList.add('active');
        }
    });

    const tooltipTitleCallback = (tooltipItems) => {
        const item = tooltipItems[0];
        let label = item.chart.data.labels[item.dataIndex];
        return Array.isArray(label) ? label.join(' ') : label;
    };

    // Interactive Complexity Chart
    const complexityCtx = document.getElementById('complexityChart').getContext('2d');
    const sequenceLengthSlider = document.getElementById('sequenceLength');
    const sequenceLengthValue = document.getElementById('sequenceLengthValue');
    const complexityText = document.getElementById('complexity-text');

    let complexityChart = new Chart(complexityCtx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [{
                label: '어텐션 (O(N²))',
                data: [],
                borderColor: '#ef4444',
                backgroundColor: '#ef444420',
                tension: 0.1,
                fill: true,
            }, {
                label: 'SSM/Hymba (O(N))',
                data: [],
                borderColor: '#3b82f6',
                backgroundColor: '#3b82f620',
                tension: 0.1,
                fill: true,
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    title: { display: true, text: '상대적 계산 비용' }
                },
                x: {
                    title: { display: true, text: '시퀀스 길이 (N)' }
                }
            },
            plugins: {
                tooltip: {
                    callbacks: {
                        title: tooltipTitleCallback,
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.y !== null) {
                                label += context.parsed.y.toLocaleString();
                            }
                            return label;
                        }
                    }
                }
            }
        }
    });

    function updateComplexityChart() {
        const n = parseInt(sequenceLengthSlider.value);
        sequenceLengthValue.textContent = n;

        const labels = [];
        const attentionData = [];
        const ssmData = [];
        
        const steps = 10;
        for (let i = 0; i <= steps; i++) {
            const current_n = Math.floor(n / steps * i);
            if(current_n < 64) {
                if (i === 0) labels.push(0); // Ensure origin is plotted
                continue;
            };
            labels.push(current_n);
            attentionData.push(Math.pow(current_n / 64, 2)); 
            ssmData.push(current_n / 64 * 10);
        }

        complexityChart.data.labels = labels;
        complexityChart.data.datasets[0].data = attentionData;
        complexityChart.data.datasets[1].data = ssmData;
        complexityChart.update();

        const lastAttentionCost = attentionData[attentionData.length - 1] || 0;
        const lastSsmCost = ssmData[ssmData.length - 1] || 0;
        const ratio = lastSsmCost > 0 ? (lastAttentionCost / lastSsmCost) : Infinity;

        complexityText.innerHTML = `시퀀스 길이 <strong>${n}</strong>에서, 어텐션의 상대적 계산 비용은 <strong>${Math.round(lastAttentionCost).toLocaleString()}</strong>이며, SSM의 비용 <strong>${Math.round(lastSsmCost).toLocaleString()}</strong>보다 약 <strong class="text-red-500">${ratio.toFixed(1)}배</strong> 더 높습니다.`;
    }

    sequenceLengthSlider.addEventListener('input', updateComplexityChart);
    updateComplexityChart();

    // Performance Chart
    const performanceCtx = document.getElementById('performanceChart').getContext('2d');
    new Chart(performanceCtx, {
        type: 'bar',
        data: {
            labels: [['KV 캐시 크기', '(11.67x 감소)'], ['처리량', '(3.49x 향상)']],
            datasets: [{
                label: '기존 트랜스포머',
                data: [11.67, 1],
                backgroundColor: '#CAF0F8',
                borderColor: '#90E0EF',
                borderWidth: 1
            }, {
                label: 'Hymba',
                data: [1, 3.49],
                backgroundColor: '#00B4D8',
                borderColor: '#0077B6',
                borderWidth: 1
            }]
        },
        options: {
            indexAxis: 'y', responsive: true, maintainAspectRatio: false,
            scales: { x: { beginAtZero: true, title: { display: true, text: '상대적 성능 (배수)' } } },
            plugins: { 
                legend: { position: 'bottom' }, 
                tooltip: { 
                    callbacks: { 
                        title: tooltipTitleCallback 
                    } 
                } 
            }
        }
    });
});
</script>
</body>
</html>
