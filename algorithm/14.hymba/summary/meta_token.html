<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hymba: 메타 토큰 심층 분석</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f8fafc; }
        .gradient-text { background: linear-gradient(to right, #0077B6, #00B4D8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .nav-link { @apply px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-blue-100 hover:text-blue-800 transition-colors; }
        .nav-link.active { @apply bg-blue-600 text-white hover:bg-blue-700; }
        .content-card { background-color: white; border-radius: 0.75rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1); padding: 2.5rem; border: 1px solid #e5e7eb; }
        h2 { @apply text-3xl font-bold text-gray-800 mb-4 border-l-4 border-blue-500 pl-4; }
        p { @apply text-gray-700 leading-relaxed; }
        .chart-container-sm { position: relative; width: 100%; max-width: 600px; margin-left: auto; margin-right: auto; height: 40vh; max-height: 400px; }
    </style>
</head>
<body class="text-gray-800">
    <header class="bg-white/90 backdrop-blur-sm sticky top-0 z-50 shadow-md">
        <nav class="container mx-auto px-4 py-3 flex justify-between items-center">
            <a href="./index.html" class="text-xl font-bold gradient-text">Hymba Research</a>
            <div id="nav-links" class="hidden md:flex items-center space-x-2">
                <a href="./index.html" class="nav-link">개요</a>
                <a href="./swa_kv_cache.html" class="nav-link">SWA & KV Cache</a>
                <a href="./meta_token.html" class="nav-link active">메타 토큰</a>
                <a href="./train_recipe.html" class="nav-link">학습 레시피</a>
                <a href="./design_roadmap.html" class="nav-link">설계 로드맵</a>
                <a href="./dpo_evolution.html" class="nav-link">DPO와 그 발전</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 py-12">
        <h1 class="text-4xl font-bold text-center mb-16 gradient-text">학습 가능한 메타 토큰</h1>

        <div class="space-y-12 max-w-4xl mx-auto">
            <div class="content-card">
                <h2>메타 토큰의 이중 역할</h2>
                <p>
                    Hymba는 모든 입력 시퀀스의 시작 부분에 소수의 학습 가능한 벡터, 즉 <strong>메타 토큰(meta tokens)</strong>을 추가하는 독특한 기법을 도입합니다. 이는 일종의 <strong>학습된, 암시적 프롬프트 엔지니어링(learned, implicit prompt engineering)</strong> 형태로 기능하며, 두 가지 중요한 목적을 수행합니다.
                </p>
                <ul class="mt-4 list-disc list-inside space-y-2">
                    <li><strong>어텐션 싱크 문제 해결:</strong> 모델의 주의가 의미 없이 첫 토큰에 과도하게 집중되는 '어텐션 싱크' 현상을 완화하는 '전용 흡수 장치' 역할을 합니다.</li>
                    <li><strong>암시적 프롬프트 엔지니어링:</strong> 모델이 모든 주어진 시퀀스에 대한 자체 처리를 준비하기 위해 사용하는, 내장되고 보편적으로 적용 가능한 '메타 프롬프트' 역할을 합니다. 이는 실제 입력 토큰의 처리를 안내하는 추상적인 추론 전략이나 문맥적 프레임을 인코딩하도록 학습될 수 있습니다.</li>
                </ul>
            </div>
            <div class="content-card">
                <h2>어텐션 싱크 현상과 해결</h2>
                <p>
                    표준 트랜스포머 모델에서는 초기 토큰(BOS 등)이 후속 토큰들의 정보를 집약하는 '어텐션 싱크' 역할을 하는 경향이 있습니다. 이는 모델 성능에 필수적이지만, 스트리밍 추론 시 초기 토큰이 제거되면 성능이 급격히 저하되는 문제를 야기합니다. Hymba의 메타 토큰은 이러한 '싱크' 역할을 대신 수행하여, 실제 콘텐츠 토큰들이 자신의 의미에 더 집중할 수 있도록 합니다.
                </p>
                <div class="mt-8 chart-container-sm">
                    <canvas id="attentionSinkChart"></canvas>
                </div>
            </div>
        </div>
    </main>
<script>
document.addEventListener('DOMContentLoaded', () => {
    // Navigation active state
    const navLinks = document.querySelectorAll('#nav-links .nav-link');
    const currentPage = window.location.pathname.split('/').pop() || 'index.html';
    navLinks.forEach(link => {
        if (link.getAttribute('href').includes(currentPage)) {
            link.classList.add('active');
        }
    });

    const attentionSinkCtx = document.getElementById('attentionSinkChart').getContext('2d');
    new Chart(attentionSinkCtx, {
        type: 'bar',
        data: {
            labels: ['BOS 토큰', '메타 토큰', '일반 토큰 1', '일반 토큰 2', '일반 토큰 3'],
            datasets: [{
                label: '어텐션 집중도 (가상)',
                data: [85, 90, 20, 25, 15],
                backgroundColor: [
                    'rgba(239, 68, 68, 0.7)',
                    'rgba(59, 130, 246, 0.7)',
                    'rgba(168, 162, 158, 0.7)',
                    'rgba(168, 162, 158, 0.7)',
                    'rgba(168, 162, 158, 0.7)'
                ],
                borderColor: [
                    'rgba(239, 68, 68, 1)',
                    'rgba(59, 130, 246, 1)',
                    'rgba(168, 162, 158, 1)',
                    'rgba(168, 162, 158, 1)',
                    'rgba(168, 162, 158, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                title: { display: true, text: '메타 토큰의 어텐션 싱크 역할 (개념적)' }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    title: { display: true, text: '어텐션 점수 합계' }
                }
            }
        }
    });
});
</script>
</body>
</html>
